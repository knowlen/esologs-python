# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview
This is a Python client library for the ESO Logs API v2, providing a GraphQL-based interface to access Elder Scrolls Online combat logging data. The library is built using `ariadne-codegen` for GraphQL code generation and provides both synchronous and asynchronous client implementations.

## Development Commands

### Dependencies & Environment Setup
```bash
# Install dependencies
pip install --upgrade pip
pip install -r requirements.txt

# Create virtual environment (recommended)
python -m venv env
source env/bin/activate  # On Windows: env\Scripts\activate
```

### Testing
```bash
# Run the test suite
python test.py
```

### Code Generation
```bash
# Generate GraphQL client code from schema
ariadne-codegen
```

This uses the configuration in `mini.toml` to generate Python client code from `schema.graphql` and `queries.graphql`.

## Project Architecture

### Core Components
- **`esologs/client.py`**: Main synchronous client class with all API methods
- **`esologs/async_base_client.py`**: Base async GraphQL client with HTTP/WebSocket support
- **`esologs/base_model.py`**: Base Pydantic models and utilities
- **`esologs/enums.py`**: GraphQL enum definitions
- **`esologs/exceptions.py`**: Custom exception classes for GraphQL errors

### Generated Code Structure
The majority of files in the `esologs/` directory are auto-generated by `ariadne-codegen`:
- `get_*.py` files: Individual query implementations and response models
- Each query has its own module with typed response models
- All generated classes are exported through `__init__.py`

### Authentication
Authentication is handled through OAuth2 client credentials flow:
- Use `access_token.py` to obtain access tokens
- Requires `ESOLOGS_ID` and `ESOLOGS_SECRET` environment variables
- API endpoint: `https://www.esologs.com/api/v2/client`

### Key API Methods
The client provides methods for querying:
- **Game Data**: abilities, classes, factions, items, maps, NPCs
- **Character Data**: character info, reports, encounter rankings
- **World Data**: regions, zones, encounters
- **Guild Data**: guild information
- **Report Data**: combat log reports by code
- **Rate Limiting**: API usage information

## Configuration Files
- **`mini.toml`**: ariadne-codegen configuration
- **`requirements.txt`**: Python dependencies
- **`schema.graphql`**: GraphQL schema definition
- **`queries.graphql`**: GraphQL queries for code generation

## Development Notes
- The codebase uses async/await patterns throughout
- All API responses are validated using Pydantic models
- GraphQL queries are embedded as strings in the client methods
- The library supports both HTTP and WebSocket connections for subscriptions
- Rate limiting information is available through the API

## Testing
The `test.py` file provides comprehensive testing of all API endpoints with real API calls. It requires valid ESO Logs API credentials to run.